#!/usr/bin/env zsh

# Config
LOG="${SYNCER_LOG:=/tmp/syncer.log}"
touch $LOG
echo "" >> $LOG

if [[ -z $1 || -z $2 ]]; then
  echo "$0 <before_days> <after_days>"
  exit 1
fi

# Get Reminders and Events

DATA=$(echo $1 $2 | shortcuts run Syncer)

start=$(echo $DATA | jq -r '.start')
end=$(echo $DATA | jq -r '.end')
prefixes=$(echo $DATA | jq -r '.prefixes')
reminders=$(echo $DATA | jq -r '.reminders')
events=$(echo $DATA | jq -r '.events')

echo "start=$start" >> $LOG
echo "end=$end" >> $LOG
echo "prefixes=$prefixes" >> $LOG
echo "reminders=$reminders" >> $LOG
echo "events=$events" >> $LOG
echo ""

for row in $(echo $reminders | jq -r '.[]'); do
  echo $row
done

exit 0

